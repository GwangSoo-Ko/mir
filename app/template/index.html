<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, width=device-width">
<meta name="google" content="notranslate">
<title>{{ app['name'] }}</title>
<style>
{{ css["common"]|safe }}
{{ css["device"]|safe }}
{{ css["os"]|safe }}
{{ css["custom"]|safe }}
</style>
</head>
<script>
function isSafari() {
  return /^((?!chrome|android).)*safari/i.test(navigator.userAgent);
}
if (isSafari()) {
  const style = document.createElement("style");
  style.textContent = ".att-input-select {appearance: none;}";
  document.head.appendChild(style);
}
</script>
<body>
    <div class="container">
        <div class="col1" id="col1">
            <div class="row1 gl" id="gl"></div>
            <div class="row2 gm" id="gm">
                <div class="group"></div>
                <div class="menu"></div>
            </div>
        </div>
        <div class="col2">
            <div class="row1 gh" id="gh">
                <div class="item"><a href="#" class="fold fnc-side-fold"></a></div>
                <div class="item"><a class="title att-text-size-auto"></a></div>
                <div class="item"><a class="id"></a></div>
                <div class="item"><a href="#" class="att-icon att-icon-logout" target="_win"></a></div>
            </div>
            <div class="row2 gw" id="gw"></div>
            <div id="tooltip" class="tooltip"><div class="title"></div><div class="lists"></div></div>
    </div>

    <div class="modal-layer" id="ml"></div>
    <div class="pop-layer" id="pl">
        <a href="#" class="att-icon att-icon-close fnc-close-btn" title="pop-layer-close"></a>
        <div class="context"></div>
    </div>
    <div class="pop" id="pop1">
        <div class="progress"><div class="mover"></div></div>
        <div class="head">
            <div class="title">title</div>
            <a href="#" class="att-icon att-icon-close fnc-close-btn" title="pop1-close"></a>
        </div>
        <div class="space"></div>
        <div class="foot"></div>
    </div>
    <div class="pop" id="pop2">
        <div class="head">
            <div class="title">title</div>
            <a href="#" data-entity="pop2" data-mode="align" class="att-icon fnc-link att-icon-align" title="align"></a>
            <a href="#" data-entity="pop2" data-mode="copy"  class="att-icon fnc-link att-icon-copy"  title="copy"></a>
            <a href="#" data-entity="pop2" data-mode="apply" class="att-icon fnc-link att-icon-save"  title="apply"></a>
            <a href="#" class="att-icon att-icon-close fnc-close-btn" title="pop2-close"></a>
        </div>
        <div class="space"></div>
        <div class="foot"></div>
    </div>
    <div class="pop" id="pop3">
        <div class="head">
            <div class="console"><div class="tools"><a href="#" class="att-icon att-icon-close fnc-close-btn" title="console-close"></a></div><pre>success</pre></div>
            <div class="title">title</div>
            <a href="#" data-entity="pop3" data-mode="align" class="att-icon fnc-link att-icon-align" title="align"></a>
            <a href="#" data-entity="pop3" data-mode="copy"  class="att-icon fnc-link att-icon-copy"  title="copy"></a>
            <a href="#" data-entity="pop3" data-mode="apply" class="att-icon fnc-link att-icon-save"  title="apply"></a>
            <a href="#" class="att-icon att-icon-close fnc-close-btn" title="pop3-close"></a>
        </div>
        <div class="space"></div>
        <div class="foot"></div>
    </div>
    <div class="pop" id="pop4">
        <div class="head">
            <div class="title">test</div>
        </div>
        <div class="space">
            <div class="formbox">
                <div class="body"></div>
                <div class="tail">
                    <div><span>DATA_SOURCE</span><input class="att-input att-input-text required" type="text" data-name="datasource"></div>
                    <a></a>
                </div>
            </div>
        </div>
        <div class="foot"></div>
    </div>
    <div class="pop" id="pop5">
        <div class="head">
            <div class="title">☺ Panel starting tool</div>
            <span>DATA_SOURCE</span><input type="text" data-name="datasource" class="att-input-text att-width-70" placeholder="input id">
            <a href="#" data-entity="pop5" data-mode="run" data-type="tool" data-post="1" class="att-icon fnc-link att-icon-run" title="run"></a>
            <a href="#" data-entity="pop5" data-mode="align"  class="att-icon fnc-link att-icon-align" title="align" style="display:none;""></a>
            <a href="#" data-entity="pop5" data-mode="apply" class="att-icon fnc-link att-icon-save" title="apply"></a>
            <a href="#" class="att-icon att-icon-close fnc-close-btn" title="pop5-close"></a>
        </div>
        <div class="space">
            <div class="query"><textarea class="att-input-text" data-name="query" placeholder="input query"></textarea></div>
            <div class="json"><pre class="context"></pre></div>
        </div>
        <div class="foot"></div>
    </div>
    <div class="pop" id="pop6">
        <div class="progress"><div class="mover"></div></div>
        <div class="head">
            <div class="title">View</div>
            <div class="subtitle"></div>
            <!-- a href="#" class="att-icon att-icon-edit-row fnc-view-edit" title="pop6-view-edit"></a -->
            <a href="#" class="att-icon att-icon-close fnc-close-btn" title="pop6-close"></a>
        </div>
        <div class="space">




<div class="agent-body"><div class="answer"><div class="markdown-body"><h1>분석 보고서</h1>
<h2>1. 일별 요약 분석</h2>
<p>제공된 JSON 데이터는 2025년 6월 3일부터 6월 7일까지 5일간의 회사 수익 데이터를 포함하고 있습니다. 각 날짜별 매출, 매출원가, 총이익, 영업비용, 영업이익, 이자비용, 세금, 순이익 및 순이익률을 확인할 수 있습니다.</p>
<h3>1-1. 주요 지표 변화 (일별 비교)</h3>
<p>다음 표는 각 날짜별 주요 재무 지표와 전일 대비 변화를 보여줍니다.</p>
<table>
<thead>
<tr>
<th align="left">날짜</th>
<th align="left">매출 ($)</th>
<th align="left">전일 대비 변화 ($)</th>
<th align="left">총이익 ($)</th>
<th align="left">전일 대비 변화 ($)</th>
<th align="left">영업이익 ($)</th>
<th align="left">전일 대비 변화 ($)</th>
<th align="left">순이익 ($)</th>
<th align="left">전일 대비 변화 ($)</th>
<th align="left">순이익률 (%)</th>
<th align="left">전일 대비 변화 (%)</th>
</tr>
</thead>
<tbody><tr>
<td align="left">2025-06-03</td>
<td align="left">336,759.98</td>
<td align="left">-</td>
<td align="left">104,155.78</td>
<td align="left">-</td>
<td align="left">61,095.68</td>
<td align="left">-</td>
<td align="left">36,359.71</td>
<td align="left">-</td>
<td align="left">10.80</td>
<td align="left">-</td>
</tr>
<tr>
<td align="left">2025-06-04</td>
<td align="left">338,411.97</td>
<td align="left">+1,651.99</td>
<td align="left">105,388.77</td>
<td align="left">+1,232.99</td>
<td align="left">62,142.09</td>
<td align="left">+1,046.41</td>
<td align="left">36,829.18</td>
<td align="left">+469.47</td>
<td align="left">10.88</td>
<td align="left">+0.08</td>
</tr>
<tr>
<td align="left">2025-06-05</td>
<td align="left">338,076.62</td>
<td align="left">-335.35</td>
<td align="left">104,756.55</td>
<td align="left">-632.22</td>
<td align="left">61,674.96</td>
<td align="left">-467.13</td>
<td align="left">36,288.18</td>
<td align="left">-541.00</td>
<td align="left">10.73</td>
<td align="left">-0.15</td>
</tr>
<tr>
<td align="left">2025-06-06</td>
<td align="left">337,517.37</td>
<td align="left">-559.25</td>
<td align="left">104,359.40</td>
<td align="left">-397.15</td>
<td align="left">61,433.37</td>
<td align="left">-241.59</td>
<td align="left">36,746.90</td>
<td align="left">+458.72</td>
<td align="left">10.89</td>
<td align="left">+0.16</td>
</tr>
<tr>
<td align="left">2025-06-07</td>
<td align="left">340,255.77</td>
<td align="left">+2,738.40</td>
<td align="left">105,763.54</td>
<td align="left">+1,404.14</td>
<td align="left">62,368.42</td>
<td align="left">+935.05</td>
<td align="left">36,983.95</td>
<td align="left">+237.05</td>
<td align="left">10.87</td>
<td align="left">-0.02</td>
</tr>
</tbody></table>
<h3>1-2. 분석 요약</h3>
<ul>
<li><strong class="att-highlight">매출:</strong> 분석 기간 동안 매출은 33만 6천 달러에서 34만 달러 사이를 오갔습니다. 6월 4일에 전일 대비 증가했으나, 6월 5일과 6일에는 소폭 감소했습니다. 그러나 6월 7일에는 가장 큰 폭(약 2,738달러)으로 증가하며 주간 최고 매출을 기록했습니다.</li>
<li><strong class="att-highlight">총이익 및 영업이익:</strong> 매출과 유사하게 총이익과 영업이익도 6월 4일에 증가한 후 6월 5일과 6일에는 감소세를 보였습니다. 6월 7일에는 매출 증가에 힘입어 총이익과 영업이익 모두 가장 높은 수준으로 회복되었습니다.</li>
<li><strong class="att-highlight">순이익:</strong> 순이익은 6월 4일에 증가했다가 6월 5일에 감소했으며, 6월 6일에 다시 증가한 후 6월 7일에도 소폭 증가하여 주간 최고치를 기록했습니다.</li>
<li><strong class="att-highlight">순이익률:</strong> 순이익률은 10.73%에서 10.89% 사이를 유지하며 비교적 안정적인 모습을 보였습니다. 6월 6일에 10.89%로 가장 높은 순이익률을 기록했습니다.</li>
</ul>
<p>전반적으로 주 초반에 소폭의 변동이 있었으나, 주말(6월 7일)로 갈수록 매출, 총이익, 영업이익, 순이익 등 주요 수익 지표가 개선되는 긍정적인 추세를 보였습니다.</p>
<h2>2. 종합적인 통찰 및 권고</h2>
<h3>2-1. 주요 통찰</h3>
<ul>
<li><strong class="att-highlight">긍정적인 주간 마감:</strong> 분석 기간의 마지막 날인 6월 7일에 매출, 총이익, 영업이익, 순이익이 모두 주간 최고치를 기록하며 긍정적인 흐름으로 한 주를 마감했습니다. 이는 단기적인 실적 개선의 신호로 해석될 수 있습니다.</li>
<li><strong class="att-highlight">안정적인 수익성:</strong> 순이익률이 10% 후반대에서 안정적으로 유지되고 있어, 매출 변동에도 불구하고 회사의 기본적인 수익 창출 능력은 견고하다고 볼 수 있습니다.</li>
<li><strong class="att-highlight">비용 관리의 중요성:</strong> 매출원가와 영업비용이 매출에 비례하여 변동하는 경향을 보입니다. 특히 6월 5일과 6일의 매출 감소 시기에도 비용이 크게 줄어들지 않아 순이익에 부정적인 영향을 미쳤습니다.</li>
</ul>
<h3>2-2. 권고</h3>
<ul>
<li><strong class="att-highlight">매출 성장 모멘텀 유지:</strong> 6월 7일의 매출 증가세를 분석하여 어떤 요인이 기여했는지 파악하고, 이러한 긍정적인 모멘텀을 다음 주에도 이어갈 수 있는 전략을 수립해야 합니다. (예: 특정 제품/서비스의 판매 호조, 마케팅 활동의 효과 등)</li>
<li><strong class="att-highlight">비용 효율성 검토:</strong> 매출이 감소하는 시기에도 수익성을 유지하기 위해 매출원가 및 영업비용의 효율성을 지속적으로 검토하고 관리할 필요가 있습니다. 특히 고정비 성격의 비용에 대한 면밀한 분석이 필요합니다.</li>
<li><strong class="att-highlight">주간/월간 추세 분석 확대:</strong> 5일간의 데이터는 단기적인 추세만을 보여주므로, 더 긴 기간(주간, 월간, 분기별)의 데이터를 분석하여 계절성, 시장 변화 등 거시적인 요인이 재무 성과에 미치는 영향을 파악하는 것이 중요합니다. 이를 통해 보다 장기적인 성장 전략을 수립할 수 있습니다.</li>
</ul>
</div></div><div class="question">가장 중요한 특이점 2가지만 요약해주세요</div><div class="answer"><div class="markdown-body"><p>제공된 데이터에서 가장 중요한 특이점 두 가지는 다음과 같습니다.</p>
<ol>
<li><strong class="att-highlight">6월 6일의 순이익 증가:</strong> 매출, 매출원가, 총이익, 영업비용, 영업이익 등 상위 재무 지표들이 전일 대비 감소했음에도 불구하고, 순이익은 오히려 증가했습니다. 이는 일반적인 손익계산서의 흐름과 상이한 특이점으로, 영업외 손익(이자비용, 세금)의 변동이 순이익에 예상치 못한 긍정적인 영향을 미쳤거나, 데이터 집계 방식에 특이사항이 있을 수 있음을 시사합니다.</li>
<li><strong class="att-highlight">6월 7일의 순이익률 소폭 하락:</strong> 6월 7일은 매출, 총이익, 영업이익, 순이익 등 대부분의 수익 지표가 주간 최고치를 기록하며 크게 개선된 날입니다. 그러나 순이익률은 전일 대비 소폭 하락했습니다. 이는 매출 증가율이 순이익 증가율을 상회했음을 의미하며, 매출 성장이 이루어지는 과정에서 수익성 개선 속도가 매출 성장을 완전히 따라가지 못했음을 시사합니다.</li>
</ol>
</div></div></div>

        </div>
        <div class="foot"></div>
    </div>
    <div id="debugView" style="display:none;position:fixed;top:0;left:0;background-color:white;z-index:100;"></div>
</body>
</html>

<script src="/static/ext/jquery.3.6.0.min.js"></script>
<script src="/static/ext/jquery.cookie.1.4.1.min.js"></script>
<script src="/static/ext/jquery.ui.1.13.2.js"></script>
<script src="/static/ext/ace.1.32.7.min.js"></script>
<script src="/static/ext/sql.formatter.15.3.0.min.js"></script>
<script src="/static/ext/chart.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/marked/11.1.1/marked.min.js"></script>
<script>


// utility function
////////////////////////////////////////////////////////////////////
var _p = {
    "const": {
        "root": "/",
        "group": "/api/group",
        "menu": "/rest/menu",
        "workplace": "/rest/workplace",
        "view": "/rest/view",
        "panel": "/rest/panel",
        "execute": "/rest/execute",
        "chat": "/rest/chat",
        "search": "/rest/search",
        "uploadExcel": "/file/excel",
        "uploadFile": "/file/upload",
        "downloadFile": "/file/download?.g=",
        "downloadImage": "/file/image?.g=",
        "user": "/user/check",
        "datasource": "/check/datasource?i=",
        "query": "/check/query",
        "tool": "/check/tool",
        "ajob": "/check/ajob",
        "userChpwd": "/user/chpwd",
        "pathDelimiter": "#",
        "paramDelimiter": ";",
        "apiHost": "",
    },
    "menu0": "",
    "menu1": "",
    "user": "",
    "mode": "load",
    "group": 1,
    "title": "{{ app['name'] }}",
    "version": "{{ app['ver'] }}",
    "p":{"size":0, "i":{}},
    "tableEditType" : ["table", "arrange", "select"],
    "transParam" : {
        "@grp":".g", 
        "@idx":".i", 
        "@type":".t", 
        "@date":".d"
    },
    "chartObj": {},
    "scrollObj": {},
    "actionTask": {}
};

_p["transParamRev"] = Object.fromEntries(Object.entries(_p["transParam"]).map(([key, value]) => [value, key]));
_p["device"] = "{{ device }}";

var _l = "{{ locale['lang']|safe }}";
var _m = {};
{{ locale['lang_js']|safe }}

var lastVisitGroupCookieName =  "mir.v.g";

// init
var queryParams = getQueryParams();
if (queryParams[".g"]) {
    _p["group"] = queryParams[".g"];
} else if (lastVisitGroupCookieName) {
    _p["group"] = $.cookie(lastVisitGroupCookieName);
}

_p["user"] = decodeURIComponent($.cookie("{{ cookie }}."+_p["group"]+".i"));
var webSocketIo;

$(document).ready(function() {

    callAjax(_p["const"]["group"], function(obj) {
        var isValid = renderLogo(obj);
        if (isValid) {

            modal(_m[_l]["welcome"]);
            $("#gh .id").html(_p["user"])

            callAjax(_p["const"]["menu"] + "?.g=" + _p["group"], renderMenu);
            $("#gh .att-icon-logout").attr("href", "/auth/logout?.g="+ _p["group"]+"&u=" + encodeURIComponent("/?.g=" + _p["group"]));

            var url = _p["const"]["user"] + "?.g=" + _p["group"];
            callAjax(url, function(obj) {
                if (obj["data"]["chpwd"]) {
                    $("#gh .id").addClass("fnc-user-edit").attr("href","#");
                }
            });
            webSocketIo = WebSocketIO();
        }
    });

    $("#gw").on("scroll",function() {
        $("#tooltip").hide();
    });
});

function modal(msg, isHide = true) {

    var time = $("<span>").addClass("time").html("[" + getFormatTime() + "]")
    var modalId = getUniqueId();

    var obj = $(_htmls["modal"]);
    $(obj).find(".context .msg").html(time).append(msg);
    $(obj).attr("id", modalId);

    $("#ml").append(obj);
    if ( isHide ) setTimeout(function() {$("#" + modalId + ' .context a.fnc-close-btn').click();}, 2000)
    $(".progress").hide();

    return modalId;
}

function popMsg(e, msg) {

    $("#pl").css({left: (e.clientX+10) + "px", top: e.clientY + "px"});
    $("#pl .context").html(msg);
    $("#pl").show();
    
    return false;
}

function putHistory(url) {

    var stateObj = { 
        "title" : _p["title"],
        "url"   : _p["const"]["pathDelimiter"] 
                  + url 
    };
    history.pushState(stateObj, stateObj["title"], stateObj["url"]);
    //document.title = _p["title"];
}

function getQueryParams(url="") {
    // URL에서 쿼리 파라미터 부분을 추출합니다.

    if (url=="") url = document.URL;

    var queryString = url.split('?')[1];
    if (!queryString) return {};

    queryString = queryString.split(_p["const"]["pathDelimiter"])[0];
    if (!queryString) return {};

    var queryParams = queryString.split('&');
    var paramsObject = {};

    queryParams.forEach(function(param) {
        var keyValue = param.split('=');
        var key = decodeURIComponent(keyValue[0]);
        var value = decodeURIComponent(keyValue[1]);
        paramsObject[key] = value;
    });

    return paramsObject;
}


function getPath(url="") {

    if (url=="") url = document.URL;

    var path = url.split(_p["const"]["pathDelimiter"])[1];
    if (!path) return "";

    path = path.split(_p["const"]["paramDelimiter"])[0];
    if (!path) return "";

    return path;
}

function getPathParams(url="") {

    if (url=="") url = document.URL;

    var path = url.split(_p["const"]["pathDelimiter"])[1];
    if (!path) return {};

    path = path.split(_p["const"]["paramDelimiter"])[0];
    if (!path) return {};

    return getQueryParams(path);
}

function getHashParams(url="") {

    if (url=="") url = document.URL;

    var resArr = [];
    var resArr = new Array(_p["p"] ["size"]).fill("");

    var path = url.split(_p["const"]["pathDelimiter"])[1];
    if (!path) return resArr ;

    paramArr = path.split(_p["const"]["paramDelimiter"]);
    if (!paramArr) return resArr;

    for (var i=0; i<_p["p"]["size"]; i++ ) {
        if (paramArr[i+1]) resArr[i] = paramArr[i+1];
    }

    return resArr;
}

function setHashParam(seq, queryStr) {

    seq = parseInt(seq);
    
    var paramArr = getHashParams();
    var path = getPath();
    
    paramArr[seq] = queryStr ;
    var queryStr = paramArr.join(_p["const"]["paramDelimiter"]);

    var url = path 
            + _p["const"]["paramDelimiter"]
            + queryStr;

    putHistory (url);
}

function getHashParamValue(pid, name) {
    try {
        paramArr = getHashParams();
        var paramStr = new URLSearchParams(paramArr[parseInt($(pid).attr("data-seq"))]);
        var res = queryToObj(paramStr)[name];
        if (!res || res == "") return "" ;
        else return res;
    } catch(e) {return ""; }
}

function queryToObj(queryString) {

    var params = new URLSearchParams(queryString);
    var obj = {};

    params.forEach(function(value, key) {
        obj[key] = value;
    });
    return obj;
}

function getUniqueId () {
    
    return "id" + crypto.getRandomValues(new Uint32Array(1))[0].toString(36);
}

///////////////////// old functions start


function setParam(order,param) {
    var paramStr = "" ;
    $('.wp-body-panel').each(function(idx,obj) {
        var thisParam = "" ;
        if ( $(obj).attr('param') ) thisParam =  $(obj).attr('param')
        paramStr += _p.const.paramDelimiter + thisParam ;
    });


    var stateObj = { title: $('#_wp_title').text(), 
                        url: _p.const.root + 
                            _p.const.pathDelimiter + 
                            getPath() + 
                            paramStr };
    history.pushState(stateObj, stateObj.title, stateObj.url);

}

function getParam(order=-1) {

    if ( document.URL.indexOf(_p.const.paramDelimiter) === -1 ) return "" ;

    if ( order === -1 ) {
        return document.URL.substr(document.URL.indexOf(_p.const.paramDelimiter)+1);
    } else {

        var paramStr = document.URL.substr(document.URL.indexOf(_p.const.paramDelimiter)+1);
        var paramArr = paramStr.split(_p.const.paramDelimiter);

        if (paramArr[order]) return paramArr[order];
        else return "" ;
    }
}
/////////////// old functions end

// window global function
////////////////////////////////////////////////////////////////////

$(window)
.on ("hashchange", function() {
    callPage();
});

function callPage() {
    
    var qpParam = getQueryParams();
    if (qpParam["g"] && _p["group"] != qpParam["g"] ) {
        location.href = document.URL;
    } else {
        actMenu();
    }
}

function actMenu() {

    _p["mode"] = "load";

    var pathParam = getPathParams();
    
    if (pathParam[".g"] && pathParam[".i"]) {
        var tarObj = $("#gm .menu a[data-g='"+pathParam[".g"]+"'][data-i='"+pathParam[".i"]+"']");
        $(tarObj).parent().prev().click();
        $(tarObj).click();
    } else {
        if ( $("#gl .title").attr("data-start") && $("#gl .title").attr("data-start") != "") {
            var tarObj = $("#gm .menu a[data-i='"+ $("#gl .title").attr("data-start") + "']");
            $(tarObj).click();
        }
    }
    
    _p["mode"] = "click";
}



// call function
////////////////////////////////////////////////////////////////////

function callPanel(panelObj) {
    callPanelCustom(panelObj, renderPanel);
}

function callPanelCustom(panelObj, callback, extraParams = null ) {

    url = getPanelUrl(panelObj, extraParams);
    callAjax(url, callback);
}

function getPanelUrl( panelObj, extraParams = null ) {

    var url = _p["const"]["panel"] 
            + "?.g=" + $(panelObj).attr("data-g")
            + "&.i=" + $(panelObj).attr("data-i");
    
    var queryStr = getHashParams()[parseInt($(panelObj).attr("data-seq"))];
    if ( queryStr != "" ) url += "&" + queryStr ;

    if (extraParams) {
        $.each(extraParams, function(k,v){
            url += "&" + encodeURIComponent(k) + "=" + encodeURIComponent(v)
        });
    }

    if ( $(panelObj).find(".head .tools .att-tool-reload").attr("data-clear") == "1" ) {
        url += "&.c=1";
       $(panelObj).find(".head .tools .att-tool-reload").removeAttr("data-clear");
    }

    return url;
}

var _htmls = {};
_htmls["panel"] = `
<div class="panel">
    <div class="pidx fnc-pidxinfo"></div>
    <div class="pidxinfo">
        <div class="row">
            <span class="key">panel id</span><span class="val"></span>
        </div>
        <div class="row">
            <a href="#" class="key fnc-cache-clear">cache clear</a>
        </div>
    </div>
    <div class="progress"><div class="mover"></div></div>
    <div class="head">
        <div class="title"></div>
        <div class="update"></div>
        <div class="tools"></div>
    </div>
    <div class="html"></div>
    <div class="widget"></div>
    <div class="search">
        <div class="basis">
            <div class="item"><span class="value"><input type="text" class="att-input att-input-text fnc-data-find" data-value="" placeholder="search"/></span></div>
        </div>
        <div class="custom"></div>
        <div class="m-buttons">
            <a href="#" class="m-icon m-icon-search fnc-link-mobile" data-target="search"></a>
            <a href="#" class="m-icon m-icon-reload fnc-link-mobile" data-target="reload"></a>
        </div>
    </div>
    <div class="chart"></div>
    <div class="note"></div>
    <div class="action"></div>
    <div class="form">
    <div class="info"></div>
    <div class="body"></div>
    <div class="result"></div>
    </div>
</div>
`;

_htmls["date-pick"] = `
<div class="date-pick">
    <div class="head">
        Date pick
        <a href="#" class="att-icon att-icon-close fnc-close-btn" title="date-pick-close"></a>
    </div>
    <div class="body">
        <div class="defined">
            <a href="#" class="fnc-date-pick-value" data-value="Today">Today</a>
            <a href="#" class="fnc-date-pick-value" data-value="Yesterday">Yesterday</a>
            <a href="#" class="fnc-date-pick-value" data-value="2_days_ago">2_days_ago</a>
            <a href="#" class="fnc-date-pick-value" data-value="3_days_ago">3_days_ago</a>
            <a href="#" class="fnc-date-pick-value" data-value="4_days_ago">4_days_ago</a>
        </div>
        <div class="defined">
            <a href="#" class="fnc-date-pick-value" data-value="Last_7_days">Last_7_days</a>
            <a href="#" class="fnc-date-pick-value" data-value="Last_14_days">Last_14_days</a>
            <a href="#" class="fnc-date-pick-value" data-value="Last_30_days">Last_30_days</a>
            <a href="#" class="fnc-date-pick-value" data-value="Last_90_days">Last_90_days</a>
            <a href="#" class="fnc-date-pick-value" data-value="Last_180_days">Last_180_days</a>
        </div>
        <div class="defined">
            <a href="#" class="fnc-date-pick-value" data-value="This_year">This_year</a>
            <a href="#" class="fnc-date-pick-value" data-value="This_month">This_month</a>
        </div>
        <div class="defined">
            <a href="#" class="fnc-date-pick-value" data-value="Last_year">Last_year</a>
            <a href="#" class="fnc-date-pick-value" data-value="Last_month">Last_month</a>
            <a href="#" class="fnc-date-pick-value" data-value="Last_3_months">Last_3_months</a>
            <a href="#" class="fnc-date-pick-value" data-value="Last_6_months">Last_6_months</a>
        </div>
        <div class="custom">
            <div class="title">Custom</div>
            <div>
                <span class="label">From</span>
                <input type="date" class="att-input att-input-date" name="att-from" required pattern="\d{4}-\d{2}-\d{2}" value></input>
            </div>
            <div>
                <span class="label">To</span>
                <input type="date" class="att-input att-input-date" name="att-to" required pattern="\d{4}-\d{2}-\d{2}" value></input>
            </div>
            <div>
                <a href="#" class="att-btn fnc-date-pick-value" data-value="custom">apply</a>
                <a href="#" class="att-btn fnc-date-pick-value" data-value="none">cancel</a>
            </div>
        </div>
    </div>
</div>
`;


_htmls["draw-chart"] = `
<div class="draw-chart">
    <div class="dac-head">
        Dynamic Chart
        <a href="#" class="att-icon att-icon-close fnc-close-btn" title="draw-chart-close"></a>
    </div>
    <div class="dac-body">
        <div class="dac-custom">
            <div class="dac-title">custom</div>
            <div class="dac-mode fnc-selects" data-name="mode">
                <a class="fnc-select-one fnc-select-mode att-selected-item" href="#" data-value="normal">normal</a>
                <a class="fnc-select-one fnc-select-mode" href="#" data-value="pivot">pivot</a>
            </div>
            <div class="dac-axis" data-name="x">
                <div class="dac-label">X axis</div>
                <div class="fnc-selects" data-name="x"></div>
            </div>
            <div class="dac-axis" data-name="y">
                <div class="dac-label">Y axis</div>
                <div class="fnc-selects" data-name="y"></div>
            </div>
        </div>
        <div class="dac-defined">
            <div class="dac-title dac-line">pre-defined</div>
            <select class="att-input-select" data-name="defined" name="defined" data-value="">
                <option value="">select defined chart</option>
            </select>
            <div class="dac-title dac-line">chart type</div>
            <select class="att-input-select" data-name="type" name="type" data-value="line">
                <option value="line">line</option>
                <option value="bar">bar</option>
            </select>
            <div class="dac-title dac-line">sort the values on the x-axis (normal mode only)</div>
            <div class="dac-box fnc-selects">
                <a href="#" class="fnc-select-one" data-name="xsort" data-value="1">yes</a>
                <a href="#" class="fnc-select-one att-selected-item" data-name="xsort" data-value="0">no</a>
            </div>
            <div class="dac-title">
                <a href="#" class="fnc-link att-btn" title="draw" data-entity="chart" data-mode="table" data-target="" data-type="draw">Draw</a>
                <a href="#" class="fnc-close-btn att-btn" title="draw-chart-close">cancel</a>
            </div>
        </div>
    </div>
</div>
`;

_htmls["chpwd"] = `
<div class="formbox">
    <div class="body">
        <div class="row" style="height:60px;">
            <div class="label require-mark">current password</div>
            <div class="edit"><input class="att-input att-input-text required" type="password" data-name="cur_pwd" data-alias="current password" autocomplete="new-password"></div>
        </div>
        <div class="row" style="height:60px;">
            <div class="label require-mark">new password</div>
            <div class="edit"><input class="att-input att-input-text required" type="password" data-name="new_pwd1" data-alias="new password" autocomplete="new-password"></div>
        </div>
        <div class="row" style="height:60px;">
            <div class="label require-mark">confirm new password</div>
            <div class="edit"><input class="att-input att-input-text required" type="password" data-name="new_pwd2" data-alias="confirm new password" autocomplete="new-password"></div>
        </div>
    </div>
    <div class="tail"><a class="fnc-link att-btn att-width-140" data-entity="header" data-mode="chpwd" data-type data-post="1" href="#">save</a></div>
</div>
`;

_htmls["highlight-row"] = `
<div class="att-highlight-row"></div>
`;

_htmls["modal"] = `
<div class="modal">
        <div class="context">
            <a href="#" class="att-icon att-icon-close fnc-close-btn" title="modal-close"></a>
            <div class="title">message</div>
            <div class="msg">copied!</div>
        </div>
    </div>
`;

_htmls["widget"] = `
<div class="wcard">
    <div class="header"><a></a></div>
    <div class="body">
        <div class="index">&nbsp;</div>
        <div class="cap"><span class="diff"></span><span class="rate"></span><span class="base"></span></div>
    </div>
    <div class="footer"><span class="comment fnc-wcard-index"></span></div>
    <div class="chart-area"></div>
</div>
`;


_htmls["widget-list"] = `
<div class="wcard">
    <div class="header gray"><a></a></div>
    <table class="list"></table>
</div>
`;

_htmls["widget-noti"] = `
<div class="widget-noti">
    <div><span class="name">red</span><span class="value"></span></div>
    <div><span class="name">yellow</span><span class="value"></span></div>
</div>
`;


{{ js_obj["init"]|safe }}
{{ js_obj["event"]|safe }}
{{ js_obj["play"]|safe }}
{{ js_obj["post"]|safe }}
{{ js_obj["form"]|safe }}
{{ js_obj["render"]|safe }}
{{ js_obj["table"]|safe }}
{{ js_obj["util"]|safe }}
{{ js_obj["mobile"]|safe }}

</script>

<script>

function WebSocketIO() {

    var wsProtocol = (window.location.protocol === 'https:') ? 'wss' : 'ws';
    var sUrl = wsProtocol + "://" + window.location.host + "/ws/" + encodeURIComponent(_p["user"]);
    var ws = new WebSocket(sUrl);
    var cid = "";

    ws.onopen = function(event) {
        console.log("ws.onopen: connected");
    };

    ws.onclose = function(event) {
        if (event.code==1006) return;
        setTimeout(function() {
            window.webSocketIo = WebSocketIO();
        }, 1000);
    };

    ws.onerror = function(event) {
        console.log("ws.onerror: websocket error:", event);
    };

    ws.onmessage = function(ws) {

        try {

            msgObj = JSON.parse(event.data);
            msgStr = msgObj["msg"];

            if (  msgObj["task_name"] &&  msgObj["task_name"] != "" ) {
                if ( _p["actionTask"][msgObj["task_name"]] ) {

                    msgStr =  "**" + msgObj["task_alias"] + "** " + msgStr;
                    if (msgObj["status"] == "ok") {
                       modal (msgStr, false);

                       if ( "forward" in msgObj ) {
                            var panelObj = $("#pan" + msgObj["forward"]);
                            $(panelObj).find(".head .tools .att-tool-reload").click();
                       }

                    } else if (msgObj["status"] == "error") {
                        modal("server error<hr>" + msgStr, false);
                    }
                    delete (_p["actionTask"][msgObj["task_name"]]);
                }
            } else {
                if (msgObj["status"] == "hello") cid = msgObj["cid"];
            }
        } catch (e) {};
    };

    function sendMsg(event) {
        if (ws.readyState !== WebSocket.OPEN) {
            return false;
        } else {
            ws.send("hello");
            event.preventDefault();
        }
        return false;
    }

    return {
        sendMsg: function(event) {
            return sendMsg(event);
        }
    }
}

</script>

<script>
function handleGlobalError(message, source, lineno, colno, error) {
    console.error("Global Error Handler:");
    console.error("Message:", message);
    console.error("Source:", source);
    console.error("Line:", lineno);
    console.error("Column:", colno);
    console.error("Error Object:", error);
    modal ("[line:"+lineno+"] " + message, false);
    return true;
}
window.onerror = handleGlobalError;
</script>